{
  "feature_analysis": [
    {
      "feature": "User Authentication",
      "description": "Handles user sign-in using Google and Email providers via Firebase Authentication.",
      "files": [
        "public/auth.js",
        "public/firebase-config.js",
        "public/index.html"
      ],
      "dependencies": [
        "Firebase Auth SDK",
        "FirebaseUI"
      ],
      "subfeatures": [
        {
          "feature": "Login Modal",
          "description": "UI modal for triggering login.",
          "files": ["public/index.html", "public/main.js"]
        },
        {
          "feature": "User Data Sync",
          "description": "Syncs user profile data to Firestore 'users' collection on login.",
          "files": ["public/main.js"]
        }
      ]
    },
    {
      "feature": "Quiz Engine",
      "description": "Core functionality for taking quizzes, including timer, navigation, and scoring.",
      "files": [
        "public/main.js",
        "public/index.html",
        "public/data/questions.json"
      ],
      "dependencies": [
        "Firestore (for saving results)",
        "Chart.js (for visualization)"
      ],
      "subfeatures": [
        {
          "feature": "Hybrid Question Loading",
          "description": "Loads questions from local JSON first; falls back to AI generation if empty.",
          "files": ["public/main.js", "api/generate.js"]
        },
        {
          "feature": "Exam Day Mode",
          "description": "Simulates full exam conditions with 150 questions and specific timers.",
          "files": ["public/main.js"]
        },
        {
          "feature": "Seen Question Tracking",
          "description": "Tracks answered questions in Firestore to prevent repetition.",
          "files": ["public/main.js", "instruction_guid.md"]
        }
      ]
    },
    {
      "feature": "AI Integration",
      "description": "Backend services for dynamic content generation.",
      "files": [
        "api/generate.js",
        "api/explain.js"
      ],
      "dependencies": [
        "OpenRouter API",
        "Vercel Serverless Functions"
      ],
      "subfeatures": [
        {
          "feature": "Dynamic Question Generation",
          "description": "Generates questions via AI when preset questions are exhausted.",
          "files": ["api/generate.js"]
        },
        {
          "feature": "Ask Guru (AI Explanation)",
          "description": "Provides AI-powered explanations for specific questions.",
          "files": ["api/explain.js", "public/main.js"]
        }
      ]
    },
    {
      "feature": "Payment System",
      "description": "Handles Premium upgrades using Razorpay.",
      "files": [
        "api/create-order.js",
        "api/verify-payment.js",
        "api/config.js",
        "public/main.js",
        "TROUBLESHOOTING_PAYMENTS.md"
      ],
      "dependencies": [
        "Razorpay SDK",
        "Firestore (Premium status tracking)"
      ],
      "subfeatures": []
    },
    {
      "feature": "User Dashboard",
      "description": "Displays user progress, quiz history, and analytics.",
      "files": [
        "public/index.html",
        "public/main.js"
      ],
      "dependencies": [
        "Chart.js"
      ],
      "subfeatures": [
        {
          "feature": "Progress Charts",
          "description": "Visualizes performance by category.",
          "files": ["public/main.js"]
        },
        {
          "feature": "Reset Progress",
          "description": "Allows users to clear 'seen' questions history.",
          "files": ["public/main.js"]
        }
      ]
    },
    {
      "feature": "Admin Dashboard",
      "description": "Interface for admins to view flagged questions and feedback.",
      "files": [
        "public/admin.html",
        "public/admin.js"
      ],
      "dependencies": [
        "Firestore (question_feedback collection)"
      ],
      "subfeatures": []
    },
    {
      "feature": "SEO & Static Content",
      "description": "Static pages and metadata for search engine optimization.",
      "files": [
        "public/index.html",
        "public/pages/syllabus.html",
        "public/pages/syllabus-ktet2.html",
        "public/pages/syllabus-selection.html",
        "public/sitemap.xml",
        "public/robots.txt"
      ],
      "dependencies": [],
      "subfeatures": []
    }
  ],
  "phased_plan": [
    {
      "phase": 1,
      "name": "Project Initialization & Infrastructure",
      "description": "Set up the Next.js project structure, configure Tailwind CSS using existing styles, and initialize Firebase client/server SDKs.",
      "features": [
        "Project Setup",
        "Tailwind Configuration",
        "Firebase Initialization"
      ],
      "dependencies": [],
      "prompt_template": "Initialize a new Next.js project (App Router). Install Tailwind CSS and configure it to match the design system found in `public/css/style.css` and `tailwind.config.js` from the legacy repo. Set up `lib/firebase.js` for client-side Firebase access and `lib/firebase-admin.js` for server-side access using the environment variables structure found in `.env.example`.",
      "error_handling": "If legacy CSS variables or classes are incompatible, map them to closest Tailwind utility classes."
    },
    {
      "phase": 2,
      "name": "Authentication & User Context",
      "description": "Implement global authentication state management using Next.js Context API and Firebase Auth.",
      "features": [
        "User Authentication",
        "User Data Sync"
      ],
      "dependencies": [
        "Project Initialization & Infrastructure"
      ],
      "prompt_template": "Create an AuthContext to manage user sessions. Implement the Login Modal component (replicating `public/index.html` logic) using Firebase Auth (Google & Email). On successful login, sync user data to Firestore 'users' collection as done in `initializeUserData` in `public/main.js`. Protect routes that require login.",
      "error_handling": "Ensure FirebaseUI logic is replaced with custom React components or a compatible React wrapper for FirebaseUI."
    },
    {
      "phase": 3,
      "name": "Static Content & SEO Migration",
      "description": "Migrate static syllabus pages, homepage content, and SEO configurations.",
      "features": [
        "SEO & Static Content"
      ],
      "dependencies": [
        "Project Initialization & Infrastructure"
      ],
      "prompt_template": "Migrate the content from `public/index.html` (Home), `public/pages/syllabus-selection.html`, and syllabus detail pages to Next.js Pages/Layouts. Implement the SEO metadata, JSON-LD schema, and Sitemap generation logic based on `public/sitemap.xml` and `public/robots.txt`.",
      "error_handling": "If PDF embedding behaves differently in React, use an iframe or `react-pdf`."
    },
    {
      "phase": 4,
      "name": "Quiz Engine Implementation (Frontend)",
      "description": "Build the interactive quiz interface, including the question viewer, timer, and option selection.",
      "features": [
        "Quiz Engine",
        "Exam Day Mode"
      ],
      "dependencies": [
        "Authentication & User Context"
      ],
      "prompt_template": "Develop the Quiz Interface component. Implement the logic for 'Preset Mode' (loading from `public/data/questions.json`) and 'Exam Day Experience' (150 questions, specific timers) as found in `public/main.js`. Ensure state management handles score, current question index, and timer.",
      "error_handling": "If `questions.json` is too large for client bundle, move it to a server-side API route."
    },
    {
      "phase": 5,
      "name": "Backend API Migration (AI & Data)",
      "description": "Migrate Vercel Serverless functions to Next.js API Routes.",
      "features": [
        "Hybrid Question Loading",
        "AI Integration",
        "Dynamic Question Generation"
      ],
      "dependencies": [
        "Quiz Engine Implementation (Frontend)"
      ],
      "prompt_template": "Migrate `api/generate.js` and `api/explain.js` to Next.js API Routes. Ensure they use the `OPENROUTER_API_KEY`. Update the frontend Quiz Engine to fetch from these new endpoints when preset questions are exhausted or when 'Ask Guru' is triggered.",
      "error_handling": "Handle timeouts gracefully for AI generation as seen in the legacy `api/generate.js`."
    },
    {
      "phase": 6,
      "name": "Dashboard & Analytics",
      "description": "Develop the user dashboard to display history and statistics.",
      "features": [
        "User Dashboard",
        "Seen Question Tracking",
        "Progress Charts"
      ],
      "dependencies": [
        "Authentication & User Context",
        "Quiz Engine Implementation (Frontend)"
      ],
      "prompt_template": "Create the User Dashboard page. Implement data fetching from Firestore 'quizHistory' and 'users' collections. Recreate the Chart.js visualization for 'Average Score by Category'. Implement the 'Reset Progress' functionality found in `public/main.js`.",
      "error_handling": "If Chart.js integration is complex in React, consider using `react-chartjs-2`."
    },
    {
      "phase": 7,
      "name": "Payment Gateway Integration",
      "description": "Integrate Razorpay for Premium upgrades.",
      "features": [
        "Payment System"
      ],
      "dependencies": [
        "Authentication & User Context",
        "Backend API Migration (AI & Data)"
      ],
      "prompt_template": "Migrate `api/create-order.js` and `api/verify-payment.js` to Next.js API Routes. Create the Premium Upgrade modal in the frontend. Implement the Razorpay checkout flow and update the user's 'isPremium' status in Firestore upon successful verification.",
      "error_handling": "Ensure environment variables for Razorpay keys are correctly configured in Next.js."
    },
    {
      "phase": 8,
      "name": "Admin & Feedback System",
      "description": "Implement the Admin Dashboard and User Feedback/Correction features.",
      "features": [
        "Admin Dashboard",
        "Feedback System"
      ],
      "dependencies": [
        "Authentication & User Context"
      ],
      "prompt_template": "Create a protected Admin route accessible only to specific UIDs. Migrate the logic from `public/admin.js` to fetch and display flagged questions. Implement the 'Suggest Correction' and 'Feedback' modals on the frontend and connect them to Firestore.",
      "error_handling": "Verify Firestore rules allow writes to feedback collections for authenticated users."
    }
  ]
}